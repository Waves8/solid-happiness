# From http://superuser.com/questions/333733/how-can-i-tell-which-domain-controller-im-authenticated-to
# To determine computer/server DC use NLTEST
nltest /dsgetdc:<domain_name>

# To list all DC's with their appropriate site, try
nltest /dclist:<domain_name>

# You don't have to use the FQDN of the domain name or server
# For example, instead of saying
/dclist:services.microsoft.com
# You can simply type
/dclist:services
# as long as you are an authenticated member of that domain

# For user authentication and group policy use LOGONSERVER variable
echo %logonserver%

# Connect to Exchange-Online
# https://docs.microsoft.com/en-us/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps
Set-ExecutionPolicy -Scope process -ExecutionPolicy RemoteSigned
$UserCredential = Get-Credential
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionURI https://outlook.office365.com/powershell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection
Import-PSSession $Session
# This is supposed to be how to disconnect it, but I've been encountering an error
Remove-PSSession $Session
